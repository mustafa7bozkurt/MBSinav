<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>MBSınav</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e293b">
</head>

<body>

    <!-- Header -->
    <header class="app-header">
        <div class="logo-area">
            <i class="fas fa-graduation-cap logo-icon"></i>
            <div>
                <h1>MBSınav<small>Öğrenci Asistanı</small></h1>
            </div>
        </div>
        <div>
            <!-- Notification Icon Placeholder -->
            <i class="far fa-bell" style="font-size: 1.4rem; color: #94a3b8;"></i>
        </div>
    </header>

    <main>
        <!-- SECTION 1: ANA SAYFA (Dashboard) -->
        <section id="tab-home" class="mode-section active">
            <div class="page-title">
                <h2>Genel Bakış</h2>
            </div>

            <!-- Big Result Display (Countdown) -->
            <div class="result-display" onclick="openDateModal()" style="cursor:pointer;"
                title="Tarihi değiştirmek için tıkla">
                <span class="result-label">Sınava Kalan</span>
                <div class="countdown-grid" id="countdown-display">
                    <!-- JS Injected -->
                    <div class="time-box"><span class="time-val">--</span><span class="time-label">GÜN</span></div>
                    <div class="time-box"><span class="time-val">--</span><span class="time-label">SAAT</span></div>
                    <div class="time-box"><span class="time-val">--</span><span class="time-label">DK</span></div>
                </div>
                <div style="font-size:0.75rem; color:#64748b; margin-top:5px;">(Değiştirmek için tıkla)</div>
            </div>

            <!-- Horizontal Selector (Quick Actions or Status) -->
            <div class="shape-selector">
                <div class="shape-btn active" onclick="handleQuickMenu('durum')">
                    <i class="fas fa-chart-pie"></i>
                    <span>Durum</span>
                </div>
                <div class="shape-btn" onclick="handleQuickMenu('hedefler')">
                    <i class="fas fa-bullseye"></i>
                    <span>Hedefler</span>
                </div>
                <div class="shape-btn" onclick="handleQuickMenu('netler')">
                    <i class="fas fa-chart-line"></i>
                    <span>Netler</span>
                </div>
                <div class="shape-btn" onclick="handleQuickMenu('notlar')">
                    <i class="fas fa-sticky-note"></i>
                    <span>Notlar</span>
                </div>
            </div>

            <!-- Form Section (Today's Plan Preview) -->
            <div class="form-section">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <h4>Bugünün Programı</h4>
                    <span style="font-size:0.8rem; color:#3b82f6; cursor:pointer;" onclick="switchTab('program')">Tümü
                        ></span>
                </div>

                <div class="list-container">
                    <div class="list-item-card" style="border-left-color: #3b82f6;">
                        <div class="item-info">
                            <h3>Matematik - Türev</h3>
                            <span class="item-sub">14:00 - 15:30</span>
                        </div>
                        <span class="item-badge badge-blue">Bekliyor</span>
                    </div>
                    <div class="list-item-card" style="border-left-color: #10b981;">
                        <div class="item-info">
                            <h3>Paragraf Çözümü</h3>
                            <span class="item-sub">10:00 - 10:45</span>
                        </div>
                        <span class="item-badge badge-green">Tamam</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: KONULAR (Subjects) -->
        <section id="tab-subjects" class="mode-section">
            <div class="page-title">
                <h2>Konu Takibi</h2>
            </div>

            <!-- Filter Shape Selector -->
            <div class="shape-selector">
                <div class="shape-btn active" onclick="filterSubjects('all')">
                    <i class="fas fa-layer-group"></i>
                    <span>Tümü</span>
                </div>
                <div class="shape-btn" onclick="filterSubjects('mat')">
                    <i class="fas fa-infinity"></i>
                    <span>Matematik</span>
                </div>
                <div class="shape-btn" onclick="filterSubjects('tr')">
                    <i class="fas fa-book"></i>
                    <span>Türkçe</span>
                </div>
                <div class="shape-btn" onclick="filterSubjects('fen')">
                    <i class="fas fa-flask"></i>
                    <span>Fen</span>
                </div>
                <div class="shape-btn" onclick="filterSubjects('sos')">
                    <i class="fas fa-globe-europe"></i>
                    <span>Sosyal</span>
                </div>
            </div>

            <div class="form-section">
                <!-- Search Input -->
                <div style="margin-bottom:20px;">
                    <div class="input-grid" style="grid-template-columns: 1fr;">
                        <input type="text" class="form-input" placeholder="Konu ara...">
                    </div>
                </div>

                <div id="subject-list" class="list-container">
                    <div class="list-item-card" data-category="mat" style="border-left-color: #10b981;">
                        <div class="item-info">
                            <h3>Üslü Sayılar</h3>
                            <span class="item-sub">%100 Tamamlandı</span>
                        </div>
                        <i class="fas fa-check-circle" style="color:#10b981; font-size:1.5rem;"></i>
                    </div>

                    <div class="list-item-card" data-category="mat" style="border-left-color: #f97316;">
                        <div class="item-info">
                            <h3>Logaritma</h3>
                            <span class="item-sub">%45 İlerleme</span>
                        </div>
                        <span class="item-badge badge-orange">Çalışılıyor</span>
                    </div>

                    <div class="list-item-card" data-category="mat" style="border-left-color: #64748b;">
                        <div class="item-info">
                            <h3>İntegral</h3>
                            <span class="item-sub">Henüz başlanmadı</span>
                        </div>
                        <span class="item-badge" style="background:rgba(255,255,255,0.1)">Sıra Bekliyor</span>
                    </div>

                    <div class="list-item-card" data-category="tr" style="border-left-color: #f97316;">
                        <div class="item-info">
                            <h3>Paragraf</h3>
                            <span class="item-sub">%80 İlerleme</span>
                        </div>
                        <span class="item-badge badge-orange">Çalışılıyor</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: PROGRAM (Schedule) -->
        <section id="tab-program" class="mode-section">
            <!-- Sunday Reminder Banner -->
            <div id="sunday-banner"
                style="background:#f59e0b; color:black; padding:15px; border-radius:15px; margin-bottom:20px; display:none;">
                <h4 style="margin-bottom:5px;">Yeni Hafta Başlıyor!</h4>
                <p style="font-size:0.9rem; margin-bottom:10px;">Geçen haftanın programını bu haftaya kopyalamak ister
                    misin?</p>
                <div style="display:flex; gap:10px;">
                    <button class="secondary-btn" style="background:rgba(255,255,255,0.2); color:black; border:none;"
                        onclick="hideSundayBanner()">Hayır</button>
                    <button class="primary-btn" style="background:black; color:white; padding:8px;"
                        onclick="copyLastWeek()">Evet, Kopyala</button>
                </div>
            </div>

            <div class="page-title" style="display:flex; justify-content:space-between; align-items:center;">
                <h2>Haftalık Program</h2>
                <button onclick="openScheduleModal()" class="secondary-btn"
                    style="background:#3b82f6; color:white; border:none; padding:8px 16px; border-radius:8px; font-size:0.9rem; font-weight:600; cursor:pointer; display:flex; align-items:center; gap:8px;">
                    <i class="fas fa-pen"></i> Programı Düzenle
                </button>
            </div>

            <!-- Day Selector -->
            <div class="shape-selector" id="day-selector">
                <!-- JS will generate days (Pzt, Sal, Çrş...) -->
            </div>

            <!-- Schedule List -->
            <div class="form-section">
                <h4 id="schedule-day-title" style="color:#94a3b8;">Pazartesi</h4>
                <div id="schedule-list" class="list-container">
                    <!-- JS Injected Items -->
                    <div style="text-align:center; padding:20px; color:#64748b;">Yükleniyor...</div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: NET HESAP (Calculator Model) -->
        <section id="tab-exam" class="mode-section">
            <div class="page-title">
                <h2>Net Hesapla</h2>
            </div>

            <!-- Result Display Model -->
            <div class="result-display">
                <span class="result-label">Toplam Net</span>
                <div class="result-value">72.50</div>
                <span class="result-unit">NET</span>
            </div>

            <div class="form-section">
                <h4>Deneme Sonuçları</h4>

                <!-- Input Grid for TYT/AYT -->
                <div class="input-grid" style="margin-bottom:15px;">
                    <div>
                        <label class="form-label">Türkçe (D)</label>
                        <input type="number" class="form-input" value="32">
                    </div>
                    <div>
                        <label class="form-label">Türkçe (Y)</label>
                        <input type="number" class="form-input" value="8">
                    </div>
                </div>

                <div class="input-grid" style="margin-bottom:15px;">
                    <div>
                        <label class="form-label">Matematik (D)</label>
                        <input type="number" class="form-input" value="25">
                    </div>
                    <div>
                        <label class="form-label">Matematik (Y)</label>
                        <input type="number" class="form-input" value="2">
                    </div>
                </div>

                <div class="divider"></div>

                <div class="input-grid" style="margin-bottom:15px;">
                    <div>
                        <label class="form-label">Fen (D)</label>
                        <input type="number" class="form-input" value="15">
                    </div>
                    <div>
                        <label class="form-label">Sosyal (D)</label>
                        <input type="number" class="form-input" value="12">
                    </div>
                </div>

                <button class="primary-btn mt-20" onclick="calculateNet()">
                    <i class="fas fa-calculator"></i> Hesapla ve Kaydet
                </button>
            </div>
        </section>

    </main>

    <!-- Date Edit Modal -->
    <div id="date-modal" class="modal hidden"
        style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:2000; display:flex; justify-content:center; align-items:center;">
        <div class="modal-content"
            style="background:#334155; padding:25px; border-radius:20px; width:80%; max-width:350px;">
            <h3 style="color:white; margin-bottom:15px; text-align:center;">Sınav Tarihi Seç</h3>

            <label style="color:#94a3b8; font-size:0.9rem; margin-bottom:5px; display:block;">Hedef Tarih</label>
            <input type="datetime-local" id="exam-date-input" class="form-input" style="margin-bottom:20px;">

            <div style="display:flex; gap:10px;">
                <button class="secondary-btn" onclick="closeDateModal()">İptal</button>
                <button class="primary-btn" onclick="saveExamDate()">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Schedule Edit Modal -->
    <div id="schedule-modal" class="modal hidden"
        style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:2000; display:flex; justify-content:center; align-items:center;">
        <div class="modal-content"
            style="background:#334155; padding:25px; border-radius:20px; width:80%; max-width:350px;">
            <h3 style="color:white; margin-bottom:15px; text-align:center;">Program Ekle</h3>

            <label class="form-label">Gün</label>
            <select id="sch-day" class="form-input">
                <option value="1">Pazartesi</option>
                <option value="2">Salı</option>
                <option value="3">Çarşamba</option>
                <option value="4">Perşembe</option>
                <option value="5">Cuma</option>
                <option value="6">Cumartesi</option>
                <option value="0">Pazar</option>
            </select>

            <label class="form-label">Saat</label>
            <input type="time" id="sch-time" class="form-input">

            <label class="form-label">Ders / Etkinlik</label>
            <input type="text" id="sch-subject" class="form-input" placeholder="Örn: Matematik">

            <label class="form-label">Not (Opsiyonel)</label>
            <input type="text" id="sch-note" class="form-input" placeholder="Konu, detay...">

            <div style="display:flex; gap:10px; margin-top:20px;">
                <button class="secondary-btn" onclick="closeScheduleModal()">İptal</button>
                <button class="primary-btn" onclick="saveScheduleItem()">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Bottom Nav -->
    <nav id="bottom-nav">
        <button class="nav-item active" onclick="switchTab('home')">
            <i class="fas fa-home"></i>
            <span>Ana Sayfa</span>
        </button>
        <button class="nav-item" onclick="switchTab('subjects')">
            <i class="fas fa-layer-group"></i>
            <span>Konular</span>
        </button>
        <button class="nav-item" onclick="switchTab('program')">
            <i class="fas fa-calendar-day"></i>
            <span>Program</span>
        </button>
        <button class="nav-item" onclick="switchTab('exam')">
            <i class="fas fa-calculator"></i>
            <span>Netler</span>
        </button>
    </nav>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/11.2.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore-compat.js"></script>

    <script src="script.js"></script>
</body>

</html>